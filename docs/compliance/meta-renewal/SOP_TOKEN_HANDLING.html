<h1>SOP: Access Token Handling</h1>
<p>Version: 1.0
Effective Date: 2025-11-04
Owner: Security &amp; Compliance Lead</p>
<h2>1. Purpose</h2>
<p>Define standardized procedures to securely request, store, use, rotate, and revoke access and refresh tokens for Meta platform APIs.</p>
<h2>2. Scope</h2>
<p>Applies to all services and personnel handling OAuth tokens, app secrets, and API credentials within AutoPromote.</p>
<h2>3. Roles &amp; Responsibilities</h2>
<ul>
<li>Engineering: Implement secure token storage and rotation logic.</li>
<li>Security: Validate controls, monitor access, and drive remediation.</li>
<li>Operations: Manage secrets stores and access reviews.</li>
</ul>
<h2>4. Procedures</h2>
<h3>4.1 Token Request &amp; Receipt</h3>
<ul>
<li>Use OAuth flows recommended by Meta (Authorization Code with PKCE where applicable).</li>
<li>Redirect URIs must be HTTPS and pre-registered.</li>
<li>Do not log raw tokens in any environment.</li>
</ul>
<h3>4.2 Storage</h3>
<ul>
<li>Server-side only: Store tokens in encrypted secret stores or application databases with encryption at rest. Prefer short-lived tokens with refresh flow.</li>
<li>Do NOT store tokens on:<ul>
<li>Developer laptops/desktops (even company-managed)</li>
<li>Personal devices</li>
<li>Source control</li>
<li>Client-side localStorage/sessionStorage/cookies (except ephemeral session identifiers that are not access/refresh tokens)</li>
</ul>
</li>
</ul>
<h3>4.3 Access Control</h3>
<ul>
<li>Restrict token decryption/access to service identities needing them.</li>
<li>Enforce least privilege and rotate service credentials quarterly.</li>
</ul>
<h3>4.4 Usage</h3>
<ul>
<li>Transmit tokens only over TLS.</li>
<li>Use in-memory variables for the shortest feasible duration.</li>
<li>Avoid including tokens in URLs or query strings.</li>
</ul>
<h3>4.5 Rotation</h3>
<ul>
<li>Rotate app secrets at least every 180 days or on personnel changes.</li>
<li>Re-issue tokens when:<ul>
<li>User changes password or permissions</li>
<li>App scopes change</li>
<li>Suspected compromise</li>
</ul>
</li>
</ul>
<h3>4.6 Revocation</h3>
<ul>
<li>On termination or role change, revoke access tokens for affected users/staff immediately.</li>
<li>For suspected compromise, revoke tokens and force re-auth, then investigate and document root cause.</li>
</ul>
<h3>4.7 Logging &amp; Monitoring</h3>
<ul>
<li>Log token-related events without sensitive values (redact tokens).</li>
<li>Monitor for anomalous API usage; alert on off-hours spikes or geo anomalies.</li>
</ul>
<h3>4.8 Backup &amp; Recovery</h3>
<ul>
<li>Backups of encrypted token stores must remain within managed cloud storage and inherit encryption.</li>
<li>Test restoration procedures quarterly.</li>
</ul>
<h2>5. Incident Response</h2>
<ul>
<li>Contain: Revoke potentially impacted tokens; block suspicious IPs.</li>
<li>Eradicate: Patch vulnerabilities; rotate secrets; update dependencies.</li>
<li>Recover: Validate normal operation; perform limited re-enablement.</li>
<li>Lessons Learned: Document within 5 business days; update SOP/policy as needed.</li>
</ul>
<h2>6. Evidence &amp; Auditing</h2>
<ul>
<li>Maintain change tickets for rotations and revocations.</li>
<li>Keep access reviews and audit trails for at least 12 months.</li>
</ul>
<h2>7. Review Cycle</h2>
<p>Review this SOP annually or when platform requirements change.</p>
